
[编译原理（哈工大）_哔哩哔哩](https://www.bilibili.com/video/BV1zW411t7YE?from=search&seid=17662228773593089278)
[[编译原理课件.pdf]]


编译原理的编译过程有着严格的数学证明，类似[[自动机理论]]，我们首先需要了解编译相关的各种概念

# 编译器的结构

![[Pasted image 20211006003506.png|500]]


## 词法分析/扫描（Scanning）

词法分析的主要任务,从左向右逐行扫描程序的字符，识别出各个单词，确定单词的类型，将识别出的单词转为为统一的词法单元（token）形式

`token`:<种别码，属性值>

- 关键字   ， `if` `else` `then` `while` ，  一词一码          
-  标识符   ， `变量名` `数组名` `方法名`     ，  多词一码           ^df98e9
-  常量    ，  `整型` `浮点型`  `字符型` `布尔型`  ，一型一码           
-  运算符  ，  `+` `-` `<` `=` `&` `~`      ，一词一码或一型一码
-  界限符 ，   `(` `)` `{` `}`  `;`           ， 一词一码           

^2b904d

例如：

```java
while(value!=100){num++;}
```

转换为token可得到如下
```shell
while     < WHILE	,   - 	>
(		  < SLP		,   - 	>
value     < IDN		, value > 	
!=		  < NE		,   -   >
100		  < CONST	,  100  >
)		  < SRP		,   -   >
{		  < LP      ,   -   >
num		  < IDN     ,  num  >
++		  < INC     ,   -   >
;         < SEMI    ,   -   >
}         < RP      ,   -   >
```

扫描的具体实现参考[[语言及文法]]，[[自动机理论]]
## 语法分析（parsing）

语法分析器（parser）从词法分析器输出的token序列中识别出各类短语，并构建语法分析树（parser tree）

例1：

`position = initial + rate * 60;`

token序列如下

`<id,position> <=> <id,initial> <+> <id,rate> <*> <num,60> <;>`

![[Pasted image 20211006152147.png]]

例2：
变量声明语句的分析树

其文法为
- $D$ 表示声明语句
- $T$ 表示 关键字
- $IDS$ 表示变量名

 
 $\langle D\rangle \rightarrow \langle T\rangle \langle IDS \rangle;$
 $\langle T\rangle  \rightarrow int|char|bool$
 $\langle IDS\rangle \rightarrow  \langle IDS\rangle |\langle IDS\rangle , \langle IDS\rangle$

对于一个赋值语句`int a,b,c;`来说，其分析树如下
![[Pasted image 20211006152744.png]]


## 语义分析

###  收集[[#^df98e9|标识符]]的属性信息
- 种属（Kind）
- 类型（Type）
- 存储位置、长度
- 值
- 作用域
- 参数和返回值信息
	- 参数个数
	- 参数类型
	- 参数传递方式
	- 返回值类型

收集[[#^df98e9|标识符]]的属性信息会被存储在符号表
![[Pasted image 20211006161206.png]]

### 语义检查
- 变量或方法未经声明就使用
- 变量或方法名重复声明
- 运算分量类型不匹配
- 操作符与操作数之间的类型不匹配
	- 数组下标不是整数
	- 对非数组声明使用数组访问操作符
	- 对非方法名使用过程调用操作符
	- 过程调用的参数类型或数目不匹配
	- 函数返回类型有误
  
## 中间代码生成器

### 常用的中间表示形式
#### 三地址码（Three-address Code)
三地址码由类似于汇编语言的指令序列组成，每个指令最多有三个操作数（operand），可以四元式（Quadruples），即`(op,y,z,x)`来表示。
常见的三地址指令的四元式表示：

![[Pasted image 20211006162835.png|300]]

三地址指令序列可以确定一个完整运算的顺序

例如：
![[Pasted image 20211006162940.png]]

#### 语法结构树/语法树（Syntax Trees）
可参考[[AST]]

## 目标代码生成器

目标代码生成以源程序的中间表示形式作为输入，并把他映射到目标语言